(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7170],{2224:function(e,r,t){"use strict";var s=t(85893),l=t(51904);t(67294);r.Z=function(e){var r=e.label,t=e.closable,n=e.onClose;return(0,s.jsx)(l.Z,{color:"#E6F1CB",onMouseDown:function(e){e.preventDefault(),e.stopPropagation()},closable:t,onClose:n,style:{marginRight:3},children:r})}},67170:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return A}});var s=t(47568),l=t(26042),n=t(70655),o=t(85893),i=t(11163),a=t.n(i),u=t(67294),c=t(828),d=t(50261),m=t(16277),p=t(34613),f=new p.c(a()),h=function(){var e=(0,c.Z)(d.Z.useForm(),1)[0],r=(0,u.useState)(!1),t=r[0],l=r[1],o=(0,u.useState)(!1),i=o[0],a=o[1],p=(0,u.useState)(!1),h=p[0],v=p[1],g=(0,u.useState)(!1),b=g[0],_=g[1],y=(0,u.useState)(!1),S=y[0],x=y[1],C=(0,u.useState)("This field is required"),w=C[0],j=C[1],Z=(0,u.useState)([{}]),P=Z[0],q=Z[1],E=(0,u.useState)([{}]),F=E[0],B=E[1],T=(0,u.useState)(""),N=T[0],R=T[1],L=function(){var r=(0,s.Z)((function(r){return(0,n.__generator)(this,(function(t){return e.setFieldsValue({buyer:void 0}),e.setFieldsValue({supplier:void 0}),_(!1),v(!1),x(!1),m.Dr.includes(r)?(x(!0),v(!1),a(!0),f.getPosibleSelectionsCreateUsersSuppliers(r,void 0).then((function(e){var r=[];e.data.posibleSuppliers.map((function(e){r.push({label:e.supplier_company_name,value:e.id})})),q(r)})).catch((function(e){var r,t;400===e.request.status&&(j(null===(r=e.response)||void 0===r||null===(t=r.data)||void 0===t?void 0:t.message),l(!0));500===e.request.status&&(j("There's been an error. Please try again later."),l(!0))}))):m.Ht.includes(r)?(x(!1),v(!0),a(!0),f.getPosibleSelectionsCreateUsersBuyers(r,void 0,void 0).then((function(e){var r=[];e.data.posibleBuyers.map((function(e){r.push({label:e.client_company_name,value:e.id})})),B(r)})).catch((function(e){var r,t;400===e.request.status&&(j(null===(r=e.response)||void 0===r||null===(t=r.data)||void 0===t?void 0:t.message),l(!0));500===e.request.status&&(j("There's been an error. Please try again later."),l(!0))}))):m.Qg.includes(r)?(x(!1),v(!1),a(!1),_(!0)):m.aD.includes(r)&&(x(!1),v(!0),a(!1),f.getPosibleSelectionsCreateUsersBuyers(r,void 0,void 0).then((function(e){var r=[];e.data.posibleBuyers.map((function(e){r.push({label:e.client_company_name,value:e.id})})),B(r)})).catch((function(e){var r,t;400===e.request.status&&(j(null===(r=e.response)||void 0===r||null===(t=r.data)||void 0===t?void 0:t.message),l(!0));500===e.request.status&&(j("There's been an error. Please try again later."),l(!0))}))),R(r),[2]}))}));return function(e){return r.apply(this,arguments)}}(),U=function(){var e=(0,s.Z)((function(e){return(0,n.__generator)(this,(function(r){switch(r.label){case 0:return[4,f.getPosibleSelectionsCreateUsersBuyers(N,void 0,e).then((function(e){var r=[];e.data.posibleBuyers.map((function(e){r.push({label:e.client_company_name,value:e.id})})),B(r),v(!0)})).catch((function(e){var r,t;400===e.request.status&&(j(null===(r=e.response)||void 0===r||null===(t=r.data)||void 0===t?void 0:t.message),l(!0));500===e.request.status&&(j("There's been an error. Please try again later."),l(!0))}))];case 1:return r.sent(),[2]}}))}));return function(r){return e.apply(this,arguments)}}(),I=function(){var e=(0,s.Z)((function(e){return(0,n.__generator)(this,(function(r){return _(!!e),[2]}))}));return function(r){return e.apply(this,arguments)}}();return{onSelectRole:L,onSelectSupplier:U,onSelectBuyer:I,setShowError:l,setMessageError:j,showError:t,multipleBuyer:i,showBuyer:h,showSupplier:S,showUserData:b,messageError:w,possibleSupplier:P,possibleBuyers:F}},v=t(29815),g=t(89235),b=function(e,r){return{id:r,label:e,value:e}},_=function(e){return(0,o.jsx)("span",{children:e})},y=new p.c(a()),S=function(){var e=(0,u.useState)({}),r=e[0],t=e[1],s=(0,u.useState)([{}]),l=s[0],n=s[1];return(0,u.useEffect)((function(){y.userRolesToCreate().then((function(e){t(e)}))}),[]),(0,u.useEffect)((function(){if(r){var e=[];if(r[g.rC.J5.kC]){var t=r[g.rC.J5.kC].map((function(e){return b(e,e)}));e=(0,v.Z)(e).concat([{label:_(g.rC.J5.kC),options:t}])}if(r[g.rC.J5.CE]){var s=r[g.rC.J5.CE].map((function(e){return b(e,e)}));e=(0,v.Z)(e).concat([{label:_(g.rC.J5.CE),options:s}])}if(r[g.rC.J5.OV]){var l=r[g.rC.J5.OV].map((function(e){return b(e,e)}));e=(0,v.Z)(e).concat([{label:_(g.rC.J5.OV),options:l}])}if(r[g.rC.J5.CO]){var o=r[g.rC.J5.CO].map((function(e){return b(e,e)}));e=(0,v.Z)(e).concat([{label:_(g.rC.J5.CO),options:o}])}n(e)}}),[r]),{roles:l}},x=t(2224),C=t(834),w=t(51945),j=t(97183),Z=t(71230),P=t(15746),q=t(4393),E=t(99138),F=t(67527),B=t(75008),T=t(71577),N=t(25675),R=t.n(N),L=t(48522),U=t(80117),I=t.n(U),k=t(89480),J=t(90396),O=function(e,r,t){var s=(0,k.C)((function(e){return e.role})).userLevel;return(0,u.useEffect)((function(){s===J.gr.buyer&&0!==Object.keys(t[0]).length&&(e.setFieldValue("buyer",t[0].value),r(t[0].value))}),[t]),null},z=w.Z.Title,V=j.Z.Content,D=function(e){var r,t,l,a,u,m,p,f,h,v,g=e.titleForm,b=e.showError,_=e.messageError,y=e.setShowError,S=e.onSubmit,x=e.setMessageError,w=e.onSelectRole,j=e.roles,N=e.showSupplier,U=e.onSelectSupplier,k=e.possibleSupplier,J=e.showBuyer,D=e.multipleBuyer,A=e.tagRender,M=e.onSelectBuyer,Y=e.possibleBuyers,G=e.showUserData,H=e.isLoading,K=(0,i.useRouter)(),Q=(0,c.Z)(d.Z.useForm(),1)[0];return O(Q,M,Y),(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(V,{children:(0,o.jsxs)("div",{className:"".concat(I().form_container),children:[(0,o.jsx)(Z.Z,{children:(0,o.jsx)(P.Z,{children:(0,o.jsxs)("div",{style:{cursor:"pointer",color:"#888E95",width:"fit-content",fontSize:"16px"},onClick:function(){K.push("/home/users",void 0,{shallow:!0})},children:[(0,o.jsx)(C.Z,{}),"\xa0 Users"]})})}),(0,o.jsx)(z,{style:{marginBottom:"1.2rem",marginTop:"2rem",fontSize:32},level:2,children:g}),(0,o.jsxs)(q.Z,{children:[(0,o.jsxs)("div",{className:I().form_user_create,children:[b&&(0,o.jsx)(E.Z,{message:_,className:"alert_red",type:"error",showIcon:!0,closable:!0,afterClose:function(){return y(!1)},icon:(0,o.jsx)(R(),{src:"/assets/icons/alert_error.svg",alt:"logo_conexis",width:24,height:24})}),(0,o.jsxs)(d.Z,{form:Q,name:"register",onFinish:S,scrollToFirstError:!0,children:[(0,o.jsx)(Z.Z,{children:(0,o.jsx)(P.Z,{span:24,children:(0,o.jsx)("div",{children:(0,o.jsx)(d.Z.Item,{className:I().labelRequired,name:"typeUser",validateTrigger:"onSubmit",label:"Select type of user",rules:[{required:!0,validator:function(){var e=(0,s.Z)((function(e,r){return(0,n.__generator)(this,(function(e){return r?[2,Promise.resolve()]:(x("All fields are required. Please make sure all fields are filled before submitting the form."),y(!0),[2,Promise.reject()])}))}));return function(r,t){return e.apply(this,arguments)}}()}],children:(0,o.jsx)(F.Z,{className:"".concat(I().select_user_create," ","dummyClassCreateFormForBorder"),onSelect:w,style:{width:"100%",borderRight:"white"},size:"large",placeholder:"Select type of user here",suffixIcon:" ",maxTagCount:"responsive",showSearch:!0,optionFilterProp:"children",filterOption:function(e,t){return(null!==(r=null===t||void 0===t?void 0:t.value)&&void 0!==r?r:"").toLowerCase().includes(e.toLowerCase())},options:j})})})})}),N&&(0,o.jsx)(Z.Z,{children:(0,o.jsx)(P.Z,{span:24,children:(0,o.jsx)("div",{children:(0,o.jsx)(d.Z.Item,{className:I().labelRequired,name:"supplier",validateTrigger:"onSubmit",label:"Select supplier",rules:[{required:!0,validator:function(){var e=(0,s.Z)((function(e,r){return(0,n.__generator)(this,(function(e){return r?[2,Promise.resolve()]:(x("All fields are required. Please make sure all fields are filled before submitting the form."),y(!0),[2,Promise.reject()])}))}));return function(r,t){return e.apply(this,arguments)}}()}],children:(0,o.jsx)(F.Z,{className:"".concat(I().select_user_create," ","dummyClassCreateFormForBorder"),style:{width:"100%",borderRight:"white"},size:"large",placeholder:"Please input your supplier",suffixIcon:" ",maxTagCount:"responsive",showSearch:!0,optionFilterProp:"children",filterOption:function(e,r){return(null!==(t=null===r||void 0===r?void 0:r.label)&&void 0!==t?t:"").toLowerCase().includes(e.toLowerCase())},filterSort:function(e,r){return(null!==(l=null===e||void 0===e?void 0:e.label)&&void 0!==l?l:"").toLowerCase().localeCompare((null!==(a=null===r||void 0===r?void 0:r.label)&&void 0!==a?a:"").toLowerCase())},onSelect:U,options:k})})})})}),J&&(0,o.jsx)(Z.Z,{children:(0,o.jsx)(P.Z,{span:24,children:(0,o.jsx)("div",{children:(0,o.jsx)(d.Z.Item,{className:I().labelRequired,name:"buyer",validateTrigger:"onSubmit",label:D?"Select buyers":"Select buyer",rules:[{required:!0,validator:function(){var e=(0,s.Z)((function(e,r){return(0,n.__generator)(this,(function(e){return r?0===r.length?(x("All fields are required. Please make sure all fields are filled before submitting the form."),y(!0),[2,Promise.reject()]):[2,Promise.resolve()]:(x("All fields are required. Please make sure all fields are filled before submitting the form."),y(!0),[2,Promise.reject()])}))}));return function(r,t){return e.apply(this,arguments)}}()}],children:!0===D?(0,o.jsx)(F.Z,{mode:"multiple",size:"large",maxTagCount:"responsive",placeholder:"Select buyers here",className:"".concat(I().select_user_create_multiple," ","dummyClassCreateFormForBorder"),tagRender:A,style:{width:"100%"},showSearch:!0,optionFilterProp:"children",filterOption:function(e,r){return(null!==(u=null===r||void 0===r?void 0:r.label)&&void 0!==u?u:"").toLowerCase().includes(e.toLowerCase())},filterSort:function(e,r){return(null!==(m=null===e||void 0===e?void 0:e.label)&&void 0!==m?m:"").toLowerCase().localeCompare((null!==(p=null===r||void 0===r?void 0:r.label)&&void 0!==p?p:"").toLowerCase())},onSelect:M,options:Y}):(0,o.jsx)(F.Z,{className:"".concat(I().select_user_create," ","dummyClassCreateFormForBorder"),style:{width:"100%",borderRight:"white"},size:"large",placeholder:"Select buyer here",suffixIcon:" ",maxTagCount:"responsive",showSearch:!0,optionFilterProp:"children",filterOption:function(e,r){return(null!==(f=null===r||void 0===r?void 0:r.label)&&void 0!==f?f:"").toLowerCase().includes(e.toLowerCase())},filterSort:function(e,r){return(null!==(h=null===e||void 0===e?void 0:e.label)&&void 0!==h?h:"").toLowerCase().localeCompare((null!==(v=null===r||void 0===r?void 0:r.label)&&void 0!==v?v:"").toLowerCase())},onSelect:M,options:Y})})})})}),G&&(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(Z.Z,{gutter:[16,0],children:[(0,o.jsx)(P.Z,{lg:8,sm:24,xs:24,md:8,children:(0,o.jsx)("div",{children:(0,o.jsx)(d.Z.Item,{className:"".concat(I().labelRequired," ").concat(I().smallInputs),validateTrigger:"onSubmit",name:"firstName",label:"First name",rules:[{required:!0,validator:function(){var e=(0,s.Z)((function(e,r){return(0,n.__generator)(this,(function(e){return r?[2,Promise.resolve()]:(x("All fields are required. Please make sure all fields are filled before submitting the form."),y(!0),[2,Promise.reject()])}))}));return function(r,t){return e.apply(this,arguments)}}()}],children:(0,o.jsx)(B.Z,{className:I().inputLabel,size:"large",type:"text",placeholder:"Enter first name here"})})})}),(0,o.jsx)(P.Z,{lg:8,sm:24,xs:24,md:8,children:(0,o.jsx)("div",{children:(0,o.jsx)(d.Z.Item,{className:"".concat(I().labelRequired," ").concat(I().smallInputs),name:"lastName",validateTrigger:"onSubmit",label:"Last name",rules:[{required:!0,validator:function(){var e=(0,s.Z)((function(e,r){return(0,n.__generator)(this,(function(e){return r?[2,Promise.resolve()]:(x("All fields are required. Please make sure all fields are filled before submitting the form."),y(!0),[2,Promise.reject()])}))}));return function(r,t){return e.apply(this,arguments)}}()}],children:(0,o.jsx)(B.Z,{className:I().inputLabel,size:"large",type:"text",placeholder:"Enter last name here"})})})}),(0,o.jsx)(P.Z,{lg:8,sm:24,xs:24,md:8,children:(0,o.jsx)("div",{children:(0,o.jsx)(d.Z.Item,{className:I().labelRequired,name:"email",label:"Email",validateTrigger:"onSubmit",rules:[{required:!0,type:"email",validator:function(){var e=(0,s.Z)((function(e,r){return(0,n.__generator)(this,(function(e){return L.bF.test(r)?[2,Promise.resolve()]:Q.getFieldValue("buyer")&&0!==Q.getFieldValue("buyer").length&&Q.getFieldValue("firstName")&&Q.getFieldValue("lastName")?(x("Please enter a valid email address."),y(!0),[2,Promise.reject()]):[2,Promise.reject()]}))}));return function(r,t){return e.apply(this,arguments)}}()}],children:(0,o.jsx)(B.Z,{className:I().inputLabel,size:"large",placeholder:"example@email.com"})})})})]})}),(0,o.jsx)("div",{style:{marginTop:"24px"},children:(0,o.jsx)(T.ZP,{type:"primary",size:"large",htmlType:"submit",disabled:!G,loading:H,children:"Submit"})})]})]}),(0,o.jsx)("div",{style:{height:"4px"}})]})]})})})},A=function(e){var r=e.titleForm,t=(0,i.useRouter)(),a=(0,u.useState)(!1),c=a[0],d=a[1],m=new p.c(t),f=S().roles,v=h(),g=v.onSelectRole,b=v.onSelectSupplier,_=v.setShowError,y=v.onSelectBuyer,C=v.setMessageError,w=v.showError,j=v.multipleBuyer,Z=v.showBuyer,P=v.showSupplier,q=v.showUserData,E=v.messageError,F=v.possibleSupplier,B=v.possibleBuyers,T=function(){var e=(0,s.Z)((function(e){var r,s,o,i,a,u,c,p,f;return(0,n.__generator)(this,(function(n){switch(n.label){case 0:return r=e.typeUser,s=e.buyer,o=e.firstName,i=e.lastName,a=e.email,u=e.supplier,c={first_name:o,last_name:i,user_roles:[r],email:a,permissioned_buyers:s?s.toString().split(","):[],logged_buyer:s?null===s||void 0===s?void 0:s.toString().split(",")[0]:null},p={permissioned_suppliers:u?[u.toString()]:"",supplier:u?u.toString():null},f=(0,l.Z)({},u&&P?p:"",c),d(!0),[4,m.userCreate(f).then((function(e){t.push(e.errors&&e.errors.length?"/home/users/create/error-mail?email=".concat(encodeURIComponent(f.email),"\n               "):"/home/users/create/success-form",void 0,{shallow:!0})})).catch((function(e){var r,t,s,l,n,o,i,a,u,c;400===e.request.status?(C(null===(r=e.response)||void 0===r||null===(t=r.data)||void 0===t?void 0:t.message),_(!0),(null===(s=e.response)||void 0===s||null===(l=s.data)||void 0===l?void 0:l.message)&&(null===(n=e.response)||void 0===n||null===(o=n.data)||void 0===o?void 0:o.message.length)&&(null===(i=e.response)||void 0===i||null===(a=i.data)||void 0===a?void 0:a.message[0])&&(null===(u=e.response)||void 0===u||null===(c=u.data)||void 0===c?void 0:c.message[0].includes("email must be an ema"))&&(C("Please enter a valid email address"),_(!0))):(C("There's been an error. Please try again later."),_(!0))})).finally((function(){return d(!1)}))];case 1:return n.sent(),[2]}}))}));return function(r){return e.apply(this,arguments)}}();return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(D,{titleForm:r,showError:w,messageError:E,setShowError:_,onSubmit:T,setMessageError:C,onSelectRole:g,roles:f,showSupplier:P,onSelectSupplier:b,possibleSupplier:F,showBuyer:Z,multipleBuyer:j,tagRender:x.Z,onSelectBuyer:y,possibleBuyers:B,showUserData:q,isLoading:c})})}},80117:function(e){e.exports={form_container:"formUser_form_container__VDYM5",form_user_create:"formUser_form_user_create__sq4ZN",form_user_create_col:"formUser_form_user_create_col__4MqXr",select_user_create:"formUser_select_user_create__PYuwJ",select_user_create_multiple:"formUser_select_user_create_multiple__rI4TD",labelRequired:"formUser_labelRequired__GTi7O",smallInputs:"formUser_smallInputs__zgE16",moveToRight:"formUser_moveToRight__bA8_K"}},828:function(e,r,t){"use strict";t.d(r,{Z:function(){return n}});var s=t(13375);var l=t(91566);function n(e,r){return function(e){if(Array.isArray(e))return e}(e)||(0,s.Z)(e,r)||(0,l.Z)(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}}}]);